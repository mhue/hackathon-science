"""
Coordonnées des 24 sphères pour le kissing number en dimension 4
Réseau D4 (24-cell)
"""

import numpy as np

# Centres des 24 sphères (configuration optimale)
sphere_centers = np.array([
    [1.414213562373095, 1.414213562373095, 0.0, 0.0],
    [1.414213562373095, 0.0, 1.414213562373095, 0.0],
    [1.414213562373095, 0.0, 0.0, 1.414213562373095],
    [0.0, 1.414213562373095, 1.414213562373095, 0.0],
    [0.0, 1.414213562373095, 0.0, 1.414213562373095],
    [0.0, 0.0, 1.414213562373095, 1.414213562373095],
    [1.414213562373095, -1.414213562373095, 0.0, 0.0],
    [1.414213562373095, 0.0, -1.414213562373095, 0.0],
    [1.414213562373095, 0.0, 0.0, -1.414213562373095],
    [0.0, 1.414213562373095, -1.414213562373095, 0.0],
    [0.0, 1.414213562373095, 0.0, -1.414213562373095],
    [0.0, 0.0, 1.414213562373095, -1.414213562373095],
    [-1.414213562373095, 1.414213562373095, 0.0, 0.0],
    [-1.414213562373095, 0.0, 1.414213562373095, 0.0],
    [-1.414213562373095, 0.0, 0.0, 1.414213562373095],
    [0.0, -1.414213562373095, 1.414213562373095, 0.0],
    [0.0, -1.414213562373095, 0.0, 1.414213562373095],
    [0.0, 0.0, -1.414213562373095, 1.414213562373095],
    [-1.414213562373095, -1.414213562373095, 0.0, 0.0],
    [-1.414213562373095, 0.0, -1.414213562373095, 0.0],
    [-1.414213562373095, 0.0, 0.0, -1.414213562373095],
    [0.0, -1.414213562373095, -1.414213562373095, 0.0],
    [0.0, -1.414213562373095, 0.0, -1.414213562373095],
    [0.0, 0.0, -1.414213562373095, -1.414213562373095]
])

# Ou en utilisant sqrt(2) pour plus de précision
sqrt2 = np.sqrt(2)

sphere_centers_exact = np.array([
    [sqrt2, sqrt2, 0.0, 0.0],
    [sqrt2, 0.0, sqrt2, 0.0],
    [sqrt2, 0.0, 0.0, sqrt2],
    [0.0, sqrt2, sqrt2, 0.0],
    [0.0, sqrt2, 0.0, sqrt2],
    [0.0, 0.0, sqrt2, sqrt2],
    [sqrt2, -sqrt2, 0.0, 0.0],
    [sqrt2, 0.0, -sqrt2, 0.0],
    [sqrt2, 0.0, 0.0, -sqrt2],
    [0.0, sqrt2, -sqrt2, 0.0],
    [0.0, sqrt2, 0.0, -sqrt2],
    [0.0, 0.0, sqrt2, -sqrt2],
    [-sqrt2, sqrt2, 0.0, 0.0],
    [-sqrt2, 0.0, sqrt2, 0.0],
    [-sqrt2, 0.0, 0.0, sqrt2],
    [0.0, -sqrt2, sqrt2, 0.0],
    [0.0, -sqrt2, 0.0, sqrt2],
    [0.0, 0.0, -sqrt2, sqrt2],
    [-sqrt2, -sqrt2, 0.0, 0.0],
    [-sqrt2, 0.0, -sqrt2, 0.0],
    [-sqrt2, 0.0, 0.0, -sqrt2],
    [0.0, -sqrt2, -sqrt2, 0.0],
    [0.0, -sqrt2, 0.0, -sqrt2],
    [0.0, 0.0, -sqrt2, -sqrt2]
])


if __name__ == "__main__":
    print("Centres des 24 sphères en dimension 4:")
    print(f"Shape: {sphere_centers.shape}")
    print(f"\nNombre de sphères: {len(sphere_centers)}")
    print(f"\nPremières coordonnées:")
    print(sphere_centers[:5])
    
    # Vérification
    norms = np.linalg.norm(sphere_centers, axis=1)
    print(f"\nNormes (doivent toutes être égales à 2):")
    print(f"  Min: {norms.min():.6f}")
    print(f"  Max: {norms.max():.6f}")
    print(f"  Toutes égales: {np.allclose(norms, 2.0)}")
